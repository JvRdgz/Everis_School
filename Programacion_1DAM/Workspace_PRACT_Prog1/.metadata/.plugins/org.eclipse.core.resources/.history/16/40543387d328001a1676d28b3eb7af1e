package main;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.Scanner;

public class Main {

	static Scanner sc = new Scanner(System.in);
	static String ruta = ".\\FicherosCreados";
	static File directorio = new File(ruta);

	public static void main(String[] args) {
		crearDirectorio();
		menuPrincipal();
	}

	private static void menuPrincipal() {
		int op = 0;
		String exit = "";

		System.out.println("\n\tMENU PRINCIPAL PRACTICA 3\n\n");

		do {
			System.out.println("\t1.- Ficheros de texto: ");
			System.out.println("\t2.- Ficheros binarios: ");
			System.out.println("\t0.- Salir.");

			op = Integer.parseInt(sc.nextLine());

			while (op < 0 || op > 2) {
				System.out.println("Opcion no valida, Introduce una opcion entre 0 y 2: ");
				op = Integer.parseInt(sc.nextLine());
			}

			switch (op) {
			case 1:
				menuFicherostxt();
				break;
			case 2:
				menuFicherosBinarios();
				break;
			case 0:
				do {
					System.out.println("�Seguro que quieres salir? (S para si \\ N para no)");
					exit = sc.nextLine();
				} while (!exit.equalsIgnoreCase("S") && !exit.equalsIgnoreCase("N"));
				break;
			}

		} while (op != 0 || exit.equalsIgnoreCase("N"));
	}

	private static void menuFicherosBinarios() {
		int op = 0;
		String exit = "";

		System.out.println("\n\tMENU FICHEROS BINARIOS\n\n");

		do {
			System.out.println("\t1.- Crear fichero con el nombre FicheroBinario.bin:");
			System.out.println("\t2.- Eliminar fichero de la carpeta ficheros introduciendo su nombre:");
			System.out.println("\t3.- Renombrar un fichero introduciendo su nombre por teclado...");
			System.out.println(
					"\t4.- Escribir en el fichero una l�nea introducida por teclado que cumpla con el formato\n"
							+ "\tNombre#Apellido1#Apellido2#DNI#Edad");
			System.out.println("\t5.- Buscar una linea en el fichero a traves de un DNI:");
			System.out.println("\t6.- Eliminar una linea tras introducir un DNI:");
			System.out.println(
					"\t7.- Copiar Fichero. Esta acci�n copiar� las l�neas pares en un fichero y a continuaci�n las\n"
							+ "columnas pares. Debe de hacerse en funciones separadas. Adem�s, har� lo mismo para\n"
							+ "las l�neas y columnas impares. Los ficheros se nombrar�n de la siguiente manera.\n"
							+ "BinarioLineasPares.bin y BinarioLineasImpares.bin:");
			System.out.println(
					"\t8.- Almacenar ficheros. Esta acci�n almacenar� todos los ficheros creados en la carpeta en\n"
							+ "un array");
			System.out.println("\t0.- Salir.");

			op = Integer.parseInt(sc.nextLine());

			while (op < 0 || op > 8) {
				System.out.println("Opcion no valida, Introduce una opcion entre 0 y 8: ");
				op = Integer.parseInt(sc.nextLine());
			}

			switch (op) {
			case 1:
				unoBin();
				break;
			case 2:
				dosBin();
				break;
			case 3:
				tresBin();
				break;
			case 4:
				cuatroBin();
				break;
			case 5:
				cincoBin();
				break;
			case 6:
				seisBin();
				break;
			case 7:
				sieteBin();
				break;
			case 8:
				ochoBin();
				break;
			case 0:
				break;
			}
		} while (op != 0);
	}

	private static void ochoBin() {
		// TODO Auto-generated method stub

	}

	private static void sieteBin() {
		// TODO Auto-generated method stub

	}

	private static void seisBin() {
		// TODO Auto-generated method stub

	}

	private static void cincoBin() {
		// TODO Auto-generated method stub

	}

	private static void cuatroBin() {
		// TODO Auto-generated method stub

	}

	private static void tresBin() {
		// TODO Auto-generated method stub

	}

	private static void dosBin() {
		// TODO Auto-generated method stub

	}

	private static void unoBin() {
		// TODO Auto-generated method stub

	}

	private static void menuFicherostxt() {
		int op = 0;

		System.out.println("\n\tMENU FICHEROS DE TEXTOn\n");

		do {
			System.out.println("\t1.- Crear fichero con el nombre FicheroTexto.txt:");
			System.out.println("\t2.- Eliminar fichero de la carpeta ficheros introduciendo su nombre:");
			System.out.println("\t3.- Renombrar un fichero introduciendo su nombre por teclado...");
			System.out.println(
					"\t4.- Escribir en el fichero una l�nea introducida por teclado que cumpla con el formato\n"
							+ "\tNombre#Apellido1#Apellido2#DNI#Edad");
			System.out.println("\t5.- Buscar una linea en el fichero a traves de un DNI:");
			System.out.println("\t6.- Eliminar una linea tras introducir un DNI:");
			System.out.println(
					"\t7.- Copiar Fichero. Esta acci�n copiar� las l�neas pares en un fichero y a continuaci�n las\n"
							+ "columnas pares. Debe de hacerse en funciones separadas. Adem�s, har� lo mismo para\n"
							+ "las l�neas y columnas impares. Los ficheros se nombrar�n de la siguiente manera.\n"
							+ "TextoLineasPares.txt y TextoLineasImpares.txt ");
			System.out.println(
					"\t8.- Almacenar ficheros. Esta acci�n almacenar� todos los ficheros creados en la carpeta en\n"
							+ "un array");
			System.out.println("\t0.- Salir.");

			op = Integer.parseInt(sc.nextLine());

			while (op < 0 || op > 9) {
				System.out.println("Opcion no valida, Introduce una opcion entre 0 y 9: ");
				op = Integer.parseInt(sc.nextLine());
			}

			switch (op) {
			case 1:
				unotxt();
				break;
			case 2:
				dostxt();
				break;
			case 3:
				trestxt();
				break;
			case 4:
				cuatrotxt();
				break;
			case 5:
				cincotxt();
				break;
			case 6:
				seistxt();
				break;
			case 7:
				sietetxt();
				break;
			case 8:
				ochotxt();
				break;
			case 9:
				mostrarDirecorio();
				break;
			case 0:
				break;
			}

		} while (op != 0);
	}

	private static void mostrarDirecorio() {
		File[] f1 = directorio.listFiles();
		for (int i = 0; i < f1.length; i++)
			System.out.println(f1[i]);
	}

	private static void ochotxt() {
		// TODO Auto-generated method stub

	}

	private static void sietetxt() {
		File pares = new File(ruta + "\\TextoLineasPares.txt");
		File impares = new File(ruta + "\\TextoLineasImpares.txt");

		lineasImpares(impares);
		lineasPares(pares);
		columnasImpares(impares);
		columnasPares(pares);
	}

	private static void columnasPares(File pares) {
		try {
			BufferedReader br = new BufferedReader(new FileReader(ruta + "\\FicheroTexto.txt"));
			BufferedWriter bw = new BufferedWriter(new FileWriter(pares, true));
			String s = null;
			int cont = 0;
			while ((s = br.readLine()) != null) {
				if (cont % 2 == 0) {
					bw.write(s);
					bw.newLine();
				}
				cont++;
			}
			br.close();
			bw.close();

		} catch (FileNotFoundException e) {
			System.err.println("Error al abrir el fichero.");
			e.printStackTrace();
		} catch (IOException e) {
			System.err.println("Error en la lectura de datos");
			e.printStackTrace();
		}
	}

	private static void columnasImpares(File impares) {
		// TODO Auto-generated method stub

	}

	private static void lineasPares(File pares) {
		// TODO Auto-generated method stub

	}

	private static void lineasImpares(File impares) {
		// TODO Auto-generated method stub

	}

	private static void seistxt() {
		System.out.println("\nIntroduce DNI:");
		String dni = sc.nextLine();
		File temp = new File(ruta + "\\FicheroAux.txt");
		File fichero = new File(ruta + "\\FicheroTexto.txt");

		if (!fichero.isFile()) {
			System.err.println("El fichero no existe");
			return;
		}
		try {
			BufferedReader br = new BufferedReader(new FileReader(fichero));
			BufferedWriter bw = new BufferedWriter(new FileWriter(temp));
			String s = null;

			while ((s = br.readLine()) != null) {
				if (!s.contains(dni)) {
					bw.write(s);
					bw.newLine();
					// pw.flush();
				}
			}
			bw.close();
			br.close();

			if (!fichero.delete()) {
				System.err.println("No se ha podido eliminar el fichero temporal");
				return;
			}

			if (!temp.renameTo(fichero)) {
				System.err.println("No se ha podido renombrar el fichero temporal");

			}
		} catch (FileNotFoundException e) {
			System.err.println("Error al abrir el fichero.");
			e.printStackTrace();
		} catch (IOException e) {
			System.err.println("Error en la lectura de datos");
			e.printStackTrace();
		}

	}

	private static void cincotxt() {
		System.out.println("\nIntroduce DNI:");
		String dni = sc.nextLine();

		try {
			BufferedReader br = new BufferedReader(new FileReader(ruta + "\\FicheroTexto.txt"));
			String s = br.readLine();

			while (s != null) {
				if (s.contains(dni)) {
					System.out.println(s);
					break;
				} else
					s = br.readLine();
			}
		} catch (FileNotFoundException e) {
			System.err.println("Error al abrir el fichero.");
			e.printStackTrace();
		} catch (IOException e) {
			System.err.println("Error en la lectura de datos");
			e.printStackTrace();
		}
	}

	private static void cuatrotxt() {
		System.out.println("\nIntroduce Nombre, Apellido1, Apellido2, DNI y Edad:");
		String frase = sc.nextLine();

		try {
			BufferedWriter bw = new BufferedWriter(new FileWriter((ruta + "\\FicheroTexto.txt"), true));
			bw.write(frase.replace(' ', '#'));
			bw.newLine();
			bw.close();
		} catch (IOException e) {
			System.err.println("Error en la escritura de datos.");
			e.printStackTrace();
		}
	}

	private static void trestxt() {
		System.out.println("\nIntroduce el nombre del fichero que deseas renombrar: ");
		String fichero = sc.nextLine();
		File[] f1 = directorio.listFiles();
		for (int i = 0; i < f1.length; i++) {
			if (f1[i].getName().equals(fichero)) {
				System.out.println("Fichero encontrado. Introduce el nuevo nombre. ");
				String nuevoNombre = sc.nextLine();
				File f2 = new File(ruta, nuevoNombre);
				boolean renombrado = f1[i].renameTo(f2);
				if (renombrado)
					System.out.println("Archivo renombrado.");
				else
					System.out.println("Error al renombrar un archivo.");
			}
		}
	}

	private static void dostxt() {
		System.out.println("\nIntroduce el nombre del fichero que deseas eliminiar: ");
		String fichero = sc.nextLine();
		File[] f1 = directorio.listFiles();
		for (int i = 0; i < f1.length; i++) {
			if (f1[i].getName().equals(fichero)) {
				boolean borrado = f1[i].delete();
				if (borrado)
					System.out.println("Archivo borrado.");
				else
					System.err.println("Error al borrado un archivo.");
			}
		}
	}

	private static void unotxt() {
		File f = new File(ruta, "FicheroTexto.txt");
		if (!f.exists())
			try {
				f.createNewFile();
			} catch (IOException e) {
				System.err.println("Error al crear el fichero.");
				e.printStackTrace();
			}
	}

	private static void crearDirectorio() {
		if (!directorio.exists())
			directorio.mkdir();
	}

}
